<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        <script>
            var photo;
            function encodeImageFileAsURL() {
                var filesSelected = document.getElementById("inputFileToLoad").files;
                if (filesSelected.length > 0) {
                    var fileToLoad = filesSelected[0];

                    var fileReader = new FileReader();

                    fileReader.onload = function(fileLoadedEvent) {
                        var srcData = fileLoadedEvent.target.result; // <--- data: base64
                        var newImage = document.createElement('img');
                        newImage.src = srcData;
                        photo = srcData;
                        debugger;
                        //document.getElementById("imgTest").innerHTML = newImage.outerHTML;
                        document.getElementById("change").src = newImage.src;
                        alert("Converted Base64 version is " + document.getElementById("imgTest").innerHTML);
                        console.log("Converted Base64 version is " + document.getElementById("imgTest").innerHTML);
                    };
                    fileReader.readAsDataURL(fileToLoad);
                }
            }

            function loadDoc() {
                var xhttp = new XMLHttpRequest();
                xhttp.onreadystatechange = function() {
                    if (this.readyState == 4 && this.status == 200) {
                        document.getElementById("demo").innerHTML = this.responseText;
                    }
                };
                xhttp.open("POST", "mock", true);
                xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                if (photo) {

                    xhttp.send("photo="+encodeURIComponent(photo.substring(22)));
                }
                else {
                    alert("enter a photo");
                }
            }

        </script>
    </head>
    <body>

        <div class="jumbotron text-center">
            <h1>Music Recommender</h1>
            <p>Find your music & more!</p>
        </div>

        <nav class="navbar navbar-default">
            <div class="container-fluid">
                <div class="navbar-header">
                    <a class="navbar-brand" href="#">Page Selector</a>
                </div>
                <ul class="nav navbar-nav">
                    <li>
                        <a href="UiHomepage.html">
                        <h4 class="list-group-item-heading">HomePage</h4>
                        </a>
                    </li>
                    <li class="active">
                        <a href="imageToMusic.html">
                            <h4 class="list-group-item-heading">Image to Music</h4>
                            <small>Search for music that "sounds like" your picture</small>
                        </a>
                    </li>
                    <li><a href="#">Page 2</a></li>
                    <li><a href="#">Page 3</a></li>
                </ul>
            </div>
        </nav>

        <div class="container-fluid">
            <!-- inside this single row will be a side bar and another column for the main page-->
            <div class="row">
                <div class="col-sm-12">
                    <div class="thumbnail" align="middle">
                        <h3 align="middle">Please insert your picture:</h3>
                        <div id="imgTest"><img id="change" src ="pencil.jpg" class ="img-rounded" height="300" width="300"></div><br>
                        <!-- the input button -->
                        <input id="inputFileToLoad" type="file" onchange="encodeImageFileAsURL();" /><br>
                        <button type="button" class ="btn" onclick="loadDoc()">Request data</button>
                    </div>
                </div>
            </div>
        </div>

    </body>
</html>